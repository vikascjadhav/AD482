apiVersion: template.openshift.io/v1
kind: Template
metadata:
  name: ad482-amq-streams-18-service-registry-sql
  annotations:
    description: "AD482 AMQ Streams 1.8 - Service Registry with Ephemeral SQL Persistence"
objects:
  - apiVersion: registry.apicur.io/v1
    kind: ApicurioRegistry
    metadata:
      name: service-registry
    spec:
      configuration:
        persistence: "sql"
        sql:
          dataSource:
            url: "jdbc:postgresql://${DATABASE_SERVICE}.${DATABASE_NAMESPACE}.svc:5432/${DATABASE_NAME}"
            userName: "${DATABASE_USER}"
            password: "${DATABASE_PASSWORD}"
parameters:
- name: DATABASE_SERVICE
  displayName: Database service name
  description: The name assigned to the database service
  required: true
  value: "postgresql"
- name: DATABASE_NAMESPACE
  displayName: Namespace
  description: The namespace assigned to the database service
  required: true
- name: DATABASE_NAME
  displayName: Database name
  description: The name assigned to the database
  required: true
  value: "serviceregistry"
- name: DATABASE_USER
  displayName: Database user
  description: The user assigned to the database
  required: true
  value: "serviceregistry"
- name: DATABASE_PASSWORD
  displayName: Database password
  description: The password assigned to the database user
  required: true
  value: "serviceregistry"
